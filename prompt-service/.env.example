# Database
DATABASE_URL="file:./dev.db"
# SQLCipher encryption key - 32+ characters recommended
# Generate with: openssl rand -hex 32
DATABASE_KEY=""

# Server
PROMPT_SERVICE_PORT=3002
NODE_ENV=development

# CORS - comma-separated list of allowed origins
CORS_ORIGINS=http://localhost:3000,http://localhost:3001

# Logging
LOG_LEVEL=info

# Admin Authentication
# API key for admin UI access - required in production
# Generate with: openssl rand -hex 32
ADMIN_API_KEY=""

# Session secret for signing HttpOnly cookies
# REQUIRED in production - must be different from ADMIN_API_KEY for security
# In development, at least one of SESSION_SECRET or ADMIN_API_KEY must be set
# (SESSION_SECRET takes priority; if only ADMIN_API_KEY is set, a warning is logged)
# Generate with: openssl rand -hex 32
SESSION_SECRET=""

# JWT Authentication
# Secret key for signing access tokens - REQUIRED in production
# Generate with: openssl rand -hex 32
JWT_ACCESS_SECRET=""

# Secret key for signing refresh tokens - REQUIRED in production
# Should be different from JWT_ACCESS_SECRET for security
# Generate with: openssl rand -hex 32
JWT_REFRESH_SECRET=""

# Access token expiry duration (e.g., 15m, 1h, 1d)
JWT_ACCESS_EXPIRY=15m

# Refresh token expiry duration (e.g., 7d, 30d)
JWT_REFRESH_EXPIRY=7d

# Password Hashing
# Number of bcrypt salt rounds (10-12 recommended for production)
BCRYPT_SALT_ROUNDS=10

# SMTP Email Configuration
# SMTP server hostname
SMTP_HOST=""

# SMTP server port (587 for TLS, 465 for SSL, 25 for unencrypted)
SMTP_PORT=587

# Use secure connection (true for SSL/TLS)
SMTP_SECURE=false

# SMTP authentication username
SMTP_USER=""

# SMTP authentication password
SMTP_PASSWORD=""

# Default sender email address
SMTP_FROM=""

# Rate Limiting Configuration
# All limits are requests per window (default: 1 minute)
# Window duration in milliseconds
RATE_LIMIT_WINDOW_MS=60000

# Login endpoint limit (default: 5/min - brute force protection)
RATE_LIMIT_LOGIN=5

# Register endpoint limit (default: 5/min - account spam prevention)
RATE_LIMIT_REGISTER=5

# Password reset request limit (default: 3/min - email abuse prevention)
RATE_LIMIT_PASSWORD_RESET=3

# Password reset confirm limit (default: 3/min - email abuse prevention)
RATE_LIMIT_FORGOT_PASSWORD=3

# Token refresh limit (default: 20/min - normal auth flow needs)
RATE_LIMIT_TOKEN_REFRESH=20

# User data endpoints limit (default: 30/min - assessment/analysis operations)
RATE_LIMIT_USER_DATA=30

# Profile operations limit (default: 15/min - moderate limit)
RATE_LIMIT_PROFILE=15

# Account Lockout Configuration
# Number of failed login attempts before account lockout
LOCKOUT_MAX_ATTEMPTS=15

# Initial lockout duration in minutes (doubles with each successive lockout)
LOCKOUT_INITIAL_DURATION_MINS=15

# Maximum lockout duration in minutes (24 hours)
LOCKOUT_MAX_DURATION_MINS=1440
